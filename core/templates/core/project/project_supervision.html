{% extends "core/logged_base.html" %}

{% block content %}
{% if user.is_authenticated %}
{% if user.is_supervisor %}
<div class="breadcrumbs">
    <a href="{% url "home" %}">SPMS</a>
    &rsaquo;
    Supervisor
    &rsaquo;
    <a href="{% url "project" %}">Project</a>
    &rsaquo;
    <a class="current" href="{% url "project" %}">Project Supervision</a>
    <span class="float-right">Logged in as Supervisor</span>    
</div>
<div class="wrapper">
    <div class="row milestone mt-3 mb-3 bg-dark text-light">
        <div class="col-md-2 text-left pl-1">Semester1</div>
        <div class="col-md-1 text-left pl-1">Status</div>
        <div class="col-md-1 text-left pl-1">Start Date</div>
        <div class="col-md-1 text-left pl-1">End Date</div>
        <div class="col-md-2 text-left pl-1">Remaining Days</div>
        <div class="col-md-2 text-left pl-1">Document Title</div>
        <div class="col-md-2 text-left pl-1">Download Documentation</div>
        <div class="col-md-1 text-left pl-1">Comments</div>
    </div>
    {% for milestone in milestones %}
    <div class="row milestone mt-1">
        <div class="col-md-2 text-left pl-1"><a href=""></a>{{ milestone.milestone_name }} 
            <input type="hidden" id="myVar" name="variable" value="{{ milestone.id }}">
        </div>
        <div class="col-md-1 text-left pl-1">
            {% if milestone.status == "NS" %}Not Started
            {% elif milestone.status == "ON" %}Ongoing 
            {% else %} Finished 
            {% endif %}
        </div>
        <div class="col-md-1 text-left pl-1">
            {{ milestone.start_date }}
        </div>
        <div class="col-md-1 text-left pl-1">{{ milestone.end_date}}</div>
        <div class="col-md-2 text-left pl-1">
            {% for key,values in remaining_days.items %}
            {% if key == milestone.id %}
            {{ values }}
            {% endif %}
            {% endfor %}
        </div>
        <div class="col-md-2 text-left pl-1">Submit Documentation</div>
        <div class="col-md-2 text-left pl-1">
        <a href="" data-toggle="modal" id="modal-link" data-target="#{{ milestone.id }}">Download</a>
        <div class="modal" id="{{ milestone.id }}">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Download Documents for {{ milestone.milestone_name }}</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                        <div class="modal-body">
                            <table class="table">
                                <th>Document Title</th>
                                <th>Link</th>
                                {% for document in documents %}
                                {% if document.student_id == student.id %}
                                {% if document.milestone_id == milestone.id %}
                                <tr>
                                    <td>{{ document.title }}</td>
                                    <td><a href="{% url "download" document.id %}">Download</a></td>
                                </tr>
                                <tr>
                                </tr>
                                {% endif %}
                                {% endif %}
                                {% endfor %}
                            </table>
                        </div>
        
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>          
        </div>
        <div class="col-md-1 text-left pl-1"><a href="">Comments</a></div>
    </div>
    {% endfor %}
</div>

{% else %}
{% endif %}
{% endif %}
{% endblock %}